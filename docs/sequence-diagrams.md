# OpenWork â€” Sequence Diagrams

## 1. First Run (Fresh Install)

```
â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚     â”‚ Browser  â”‚     â”‚  Server  â”‚     â”‚  Core  â”‚     â”‚OpenClaw â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚ npm run startâ”‚                â”‚                â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚               â”‚
   â”‚              â”‚  GET /         â”‚                â”‚               â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚
   â”‚              â”‚                â”‚  listAgents()  â”‚               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚  agents=[]     â”‚               â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚  redirect /setup                â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”          â”‚
   â”‚         â”‚        ONBOARDING FLOW (/setup)          â”‚          â”‚
   â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜          â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  Select rolesâ”‚  GET /api/rolesâ”‚                â”‚               â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ loadTemplates()â”‚               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚  role templatesâ”‚                â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  Enter API   â”‚                â”‚                â”‚               â”‚
   â”‚  keys        â”‚                â”‚                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  Click Setup â”‚ POST /api/setupâ”‚                â”‚               â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚
   â”‚              â”‚                â”‚  For each role:â”‚               â”‚
   â”‚              â”‚                â”‚  generateAgent()               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚                â”‚ agents add    â”‚
   â”‚              â”‚                â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚              â”‚                â”‚                â”‚  agent createdâ”‚
   â”‚              â”‚                â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚              â”‚                â”‚  Write SOUL.md â”‚               â”‚
   â”‚              â”‚                â”‚  Write AGENTS.md               â”‚
   â”‚              â”‚                â”‚  Create skills/â”‚               â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚              â”‚                â”‚  patchConfig() â”‚               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚                â”‚ Write bindingsâ”‚
   â”‚              â”‚                â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚              â”‚                â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚              â”‚                â”‚  dbCreateAgent()               â”‚
   â”‚              â”‚                â”‚  createIntegration()           â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚  stored in SQLite              â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚              â”‚  { success, agents[] }          â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚              â”‚  redirect /    â”‚                â”‚               â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚
   â”‚              â”‚  Dashboard homeâ”‚                â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
```

## 2. Slack Message â†’ Agent Routing

```
â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚     â”‚ Slack â”‚     â”‚OpenClaw â”‚     â”‚ Router â”‚     â”‚Specialist â”‚     â”‚MCP Srvr â”‚
â”‚(Slack)â”‚    â”‚  API  â”‚     â”‚ Gateway â”‚     â”‚ Agent  â”‚     â”‚  Agent    â”‚     â”‚(GitHub) â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚ @openwork  â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚ check PRs  â”‚               â”‚              â”‚               â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚  event msg    â”‚              â”‚               â”‚               â”‚
   â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚  Binding match:              â”‚               â”‚
   â”‚            â”‚               â”‚  channel=slack               â”‚               â”‚
   â”‚            â”‚               â”‚  â†’ agentId=router            â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚  Route to    â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚  router agentâ”‚               â”‚               â”‚
   â”‚            â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚ Classify:     â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚ "check PRs"   â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚ â†’ engineering â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚ sessions_send â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚ to engineeringâ”‚               â”‚
   â”‚            â”‚               â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚  list_pull_   â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚  requests()   â”‚
   â”‚            â”‚               â”‚              â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚  PR data      â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚  formatted    â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚  response     â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚  reply in    â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚  Slack threadâ”‚               â”‚               â”‚
   â”‚            â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚               â”‚
   â”‚            â”‚  message      â”‚              â”‚               â”‚               â”‚
   â”‚            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚               â”‚               â”‚
   â”‚  "Found 3  â”‚              â”‚               â”‚               â”‚               â”‚
   â”‚   open PRs"â”‚              â”‚               â”‚               â”‚               â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚               â”‚               â”‚               â”‚
   â”‚            â”‚               â”‚              â”‚               â”‚               â”‚
```

## 3. Approval Workflow (Medium/High Risk Action)

```
â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚     â”‚ Slack â”‚     â”‚ Router â”‚     â”‚  Sales    â”‚     â”‚ Approval â”‚     â”‚ SQLite â”‚
â”‚(Slack)â”‚    â”‚       â”‚     â”‚ Agent  â”‚     â”‚  Agent    â”‚     â”‚ Engine   â”‚     â”‚        â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚ @openwork  â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚ update dealâ”‚              â”‚                â”‚               â”‚               â”‚
   â”‚ to Closed  â”‚              â”‚                â”‚               â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ route to sales â”‚               â”‚               â”‚
   â”‚            â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ checkRiskLevelâ”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ ("update_deal")               â”‚
   â”‚            â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ risk=medium   â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ createApprovalâ”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ Request()     â”‚               â”‚
   â”‚            â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚  INSERT       â”‚
   â”‚            â”‚              â”‚                â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚            â”‚              â”‚                â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚            â”‚              â”‚                â”‚  approvalId   â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ format approvalâ”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ Block Kit msg  â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚               â”‚               â”‚
   â”‚  â”‚ âš ï¸ Sales Agent wants to update  â”‚       â”‚               â”‚               â”‚
   â”‚  â”‚ Deal "Acme" to "Closed Won"    â”‚       â”‚               â”‚               â”‚
   â”‚  â”‚ Risk: Medium                    â”‚       â”‚               â”‚               â”‚
   â”‚  â”‚                                 â”‚       â”‚               â”‚               â”‚
   â”‚  â”‚  [âœ… Approve]  [âŒ Reject]      â”‚       â”‚               â”‚               â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚               â”‚               â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚ Click      â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚ [Approve]  â”‚              â”‚                â”‚               â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ resolveApprovalâ”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ (id, "approve")â”‚               â”‚               â”‚
   â”‚            â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚  UPDATE       â”‚
   â”‚            â”‚              â”‚                â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚            â”‚              â”‚                â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚            â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ resume sales   â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚ agent task     â”‚               â”‚               â”‚
   â”‚            â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ execute:      â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚ update_deal() â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º HubSpot MCPâ”‚
   â”‚            â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚  "Done! Deal   â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚   updated"     â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚               â”‚
   â”‚  âœ… Deal   â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚  updated   â”‚              â”‚                â”‚               â”‚               â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚                â”‚               â”‚               â”‚
   â”‚            â”‚              â”‚                â”‚               â”‚               â”‚
```

## 4. Dashboard â€” Integration Connect Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Admin â”‚     â”‚Dashboard â”‚     â”‚  Server  â”‚     â”‚  Core  â”‚     â”‚MCP Srvr â”‚
â”‚(Web) â”‚     â”‚ (React)  â”‚     â”‚(Express) â”‚     â”‚        â”‚     â”‚         â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  /integrations                â”‚                â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚               â”‚
   â”‚              â”‚ GET /api/registry               â”‚               â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚
   â”‚              â”‚                â”‚ listRegistry() â”‚               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚  integration cards              â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚               â”‚
   â”‚  â”‚  ğŸ”Œ Integrations             â”‚              â”‚               â”‚
   â”‚  â”‚                              â”‚              â”‚               â”‚
   â”‚  â”‚  [Search...]                 â”‚              â”‚               â”‚
   â”‚  â”‚  Allâ”‚Engâ”‚Mktgâ”‚Salesâ”‚Ops     â”‚              â”‚               â”‚
   â”‚  â”‚                              â”‚              â”‚               â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚              â”‚               â”‚
   â”‚  â”‚  â”‚ GitHub â”‚  â”‚ Linear â”‚     â”‚              â”‚               â”‚
   â”‚  â”‚  â”‚Popular â”‚  â”‚Popular â”‚     â”‚              â”‚               â”‚
   â”‚  â”‚  â”‚Connect â”‚  â”‚Connect â”‚     â”‚              â”‚               â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚              â”‚               â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚ Click        â”‚                â”‚                â”‚               â”‚
   â”‚ "Connect"    â”‚                â”‚                â”‚               â”‚
   â”‚ on GitHub    â”‚                â”‚                â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚               â”‚
   â”‚  â”‚  Connect GitHub              â”‚              â”‚               â”‚
   â”‚  â”‚                              â”‚              â”‚               â”‚
   â”‚  â”‚  ğŸ“¦ @modelcontextprotocol/   â”‚              â”‚               â”‚
   â”‚  â”‚     server-github            â”‚              â”‚               â”‚
   â”‚  â”‚  âš¡ stdio  â­ 20k           â”‚              â”‚               â”‚
   â”‚  â”‚                              â”‚              â”‚               â”‚
   â”‚  â”‚  GitHub Personal Access Tokenâ”‚              â”‚               â”‚
   â”‚  â”‚  [ghp_...              ] ğŸ‘  â”‚              â”‚               â”‚
   â”‚  â”‚                              â”‚              â”‚               â”‚
   â”‚  â”‚  [Test Connection]  [Save]   â”‚              â”‚               â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚ Click "Test" â”‚                â”‚                â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚               â”‚
   â”‚              â”‚ POST /api/integrations/github/test              â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚
   â”‚              â”‚                â”‚ checkHealth()  â”‚               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚                â”‚  spawn MCP    â”‚
   â”‚              â”‚                â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚              â”‚                â”‚                â”‚  JSON-RPC ok  â”‚
   â”‚              â”‚                â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚              â”‚                â”‚  { healthy }   â”‚               â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚  âœ… Connected  â”‚                â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚ Click "Save" â”‚                â”‚                â”‚               â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚               â”‚
   â”‚              â”‚ POST /api/integrations/github/configure         â”‚
   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚               â”‚
   â”‚              â”‚                â”‚ createInteg()  â”‚               â”‚
   â”‚              â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚               â”‚
   â”‚              â”‚                â”‚  stored        â”‚               â”‚
   â”‚              â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
   â”‚              â”‚  { success }   â”‚                â”‚               â”‚
   â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
   â”‚  Card now shows "Connected âœ“" â”‚                â”‚               â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚                â”‚               â”‚
   â”‚              â”‚                â”‚                â”‚               â”‚
```

## 5. Service Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User   â”‚     â”‚   CLI    â”‚     â”‚  Server  â”‚     â”‚ OpenClaw â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                â”‚                â”‚                â”‚
     â”‚ npm run start  â”‚                â”‚                â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚
     â”‚                â”‚ Check PID file â”‚                â”‚
     â”‚                â”‚ (not running)  â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚                â”‚ Start Express  â”‚                â”‚
     â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚
     â”‚                â”‚                â”‚ Listen :18800  â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚                â”‚ Write PID file â”‚                â”‚
     â”‚                â”‚ ~/.openwork/   â”‚                â”‚
     â”‚                â”‚ server.pid     â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚                â”‚ Open browser   â”‚                â”‚
     â”‚                â”‚ localhost:18800â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚  Dashboard     â”‚                â”‚                â”‚
     â”‚  loads in      â”‚                â”‚                â”‚
     â”‚  browser       â”‚                â”‚                â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚    ...time passes...            â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚ npm run stop   â”‚                â”‚                â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚
     â”‚                â”‚ Read PID file  â”‚                â”‚
     â”‚                â”‚ Kill process   â”‚                â”‚
     â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚
     â”‚                â”‚                â”‚ (exits)        â”‚
     â”‚                â”‚ Remove PID fileâ”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚  Server stoppedâ”‚                â”‚                â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚

â”€â”€â”€ Production (systemd) â”€â”€â”€

     â”‚ openwork install                â”‚                â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚                â”‚
     â”‚                â”‚ Create systemd â”‚                â”‚
     â”‚                â”‚ service file   â”‚                â”‚
     â”‚                â”‚ Enable + start â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
     â”‚  Service activeâ”‚                â”‚                â”‚
     â”‚  (auto-restart,â”‚                â”‚                â”‚
     â”‚   boot start)  â”‚                â”‚                â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚                â”‚
     â”‚                â”‚                â”‚                â”‚
```

## Component Map

```
openwork/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ dashboard/          â† Single React app (merged wizard + dashboard)
â”‚   â”‚   â”œâ”€â”€ /              â†’ Home (overview) or redirect to /setup
â”‚   â”‚   â”œâ”€â”€ /setup         â†’ Onboarding wizard (first-time only)
â”‚   â”‚   â”œâ”€â”€ /integrations  â†’ Viktor-style integration cards
â”‚   â”‚   â”œâ”€â”€ /agents        â†’ Agent management
â”‚   â”‚   â”œâ”€â”€ /approvals     â†’ Approval queue
â”‚   â”‚   â”œâ”€â”€ /tasks         â†’ Task list
â”‚   â”‚   â”œâ”€â”€ /activity      â†’ Activity log
â”‚   â”‚   â””â”€â”€ /settings      â†’ Config + reset
â”‚   â”‚
â”‚   â”œâ”€â”€ server/             â† Express.js API + static file server
â”‚   â”‚   â”œâ”€â”€ /api/status    â†’ System status
â”‚   â”‚   â”œâ”€â”€ /api/roles     â†’ Role templates
â”‚   â”‚   â”œâ”€â”€ /api/setup     â†’ Run setup / reset
â”‚   â”‚   â”œâ”€â”€ /api/agents    â†’ Agent CRUD
â”‚   â”‚   â”œâ”€â”€ /api/integrations â†’ Integration CRUD
â”‚   â”‚   â”œâ”€â”€ /api/approvals â†’ Approval management
â”‚   â”‚   â”œâ”€â”€ /api/tasks     â†’ Task management
â”‚   â”‚   â”œâ”€â”€ /api/registry  â†’ MCP server registry
â”‚   â”‚   â””â”€â”€ /*             â†’ Serve dashboard SPA
â”‚   â”‚
â”‚   â”œâ”€â”€ core/               â† Business logic
â”‚   â”‚   â”œâ”€â”€ db/            â†’ SQLite (better-sqlite3 + Drizzle)
â”‚   â”‚   â”œâ”€â”€ generator/     â†’ Agent workspace generator
â”‚   â”‚   â”œâ”€â”€ config/        â†’ openclaw.json patcher
â”‚   â”‚   â”œâ”€â”€ approval/      â†’ Approval engine
â”‚   â”‚   â”œâ”€â”€ registry/      â†’ MCP server registry
â”‚   â”‚   â”œâ”€â”€ health/        â†’ Integration health checker
â”‚   â”‚   â””â”€â”€ slack/         â†’ Slack Block Kit formatters
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                â† CLI commands
â”‚   â”‚   â”œâ”€â”€ start          â†’ Start server
â”‚   â”‚   â”œâ”€â”€ stop           â†’ Stop server
â”‚   â”‚   â”œâ”€â”€ status         â†’ Show status
â”‚   â”‚   â”œâ”€â”€ reset          â†’ Factory reset
â”‚   â”‚   â”œâ”€â”€ agents         â†’ Agent management
â”‚   â”‚   â””â”€â”€ install        â†’ Systemd service setup
â”‚   â”‚
â”‚   â””â”€â”€ agents/             â† Role templates + router
â”‚       â”œâ”€â”€ engineering    â†’ GitHub, Linear, Sentry
â”‚       â”œâ”€â”€ marketing      â†’ Google Ads, Analytics, PostHog
â”‚       â”œâ”€â”€ sales          â†’ HubSpot, Apollo, Calendly
â”‚       â”œâ”€â”€ support        â†’ Notion, Gmail, Zendesk
â”‚       â”œâ”€â”€ ops            â†’ Stripe, Sheets, Zapier
â”‚       â””â”€â”€ router         â†’ Intent classifier + delegator
â”‚
â”œâ”€â”€ .github/workflows/ci.yml  â† GitHub Actions (build + test)
â””â”€â”€ docs/                      â† Documentation
```
